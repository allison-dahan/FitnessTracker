@model IEnumerable<FitnessTracker.Models.Workout>

<div class="container py-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1>Workouts</h1>
        <a asp-controller="Workouts" asp-action="Create" class="btn btn-primary">
            Log New Workout
        </a>
    </div>

    <!-- Workout Statistics -->
    <div class="mb-4">
        @await Component.InvokeAsync("WorkoutStatistics")
    </div>

    <!-- Recent Workouts -->
    <div class="mb-4">
        <h3>Recent Workouts</h3>
        <div id="recent-workouts-container">
            <div class="text-center py-3">
                <div class="spinner-border" role="status">
                    <span class="visually-hidden">Loading workouts...</span>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function() {
            // Load the recent workouts via partial view
            $.ajax({
                url: '@Url.Action("GetRecentWorkouts", "Workouts")',
                type: 'GET',
                success: function(data) {
                    $('#recent-workouts-container').html(data);
                },
                error: function(xhr, status, error) {
                    $('#recent-workouts-container').html('<div class="alert alert-danger">Error loading workouts</div>');
                    console.error("AJAX Error:", error);
                }
            });
        });
    </script>
}